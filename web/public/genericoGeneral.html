<!DOCTYPE html>
<html lang="es">
<head>
    <style>
        body {
            font-size: 18px;
            background-color: #2C3E50;
            color: #ECF0F1;
            font-family: 'Arial', sans-serif;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            margin: 0;
            padding: 0;
        }
        .libro-container {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px;
            background-color: rgba(52, 73, 94, 0.8);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        .imagen-fondo {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: auto;
            z-index: 0;
            opacity: 0.5;
        }
        .libro-container h2,
        .libro-container p,
        .libro-container .botones-contenido {
            position: relative;
            z-index: 1;
            color: #ECF0F1;
        }
        h2 {
            margin: 10px 0;
            color: #3498DB;
            font-weight: bold;
        }
        p {
            margin: 5px 0;
        }
        .pdf-buttons-container {
            position: relative;
            z-index: 5;
            padding-bottom: 80px;
        }
        .pdf-buttons-container .buttons-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }
        .pdf-buttons-container .pdf-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            width: 220px;
            height: 280px;
            padding: 10px;
            text-align: center;
            background: linear-gradient(135deg, #1e1e2f, #3a3a5a);
            color: #ECF0F1;
            border: 2px solid #34495E;
            border-radius: 15px;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            overflow: hidden;
            position: relative;
        }
        .pdf-buttons-container .pdf-button:hover {
            transform: scale(1.06);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
        }
        .pdf-buttons-container .pdf-button img {
            width: 100%;
            height: auto;
            max-height: 180px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 10px;
        }
        .pdf-buttons-container .pdf-button .button-name {
            font-weight: bold;
            font-size: 1em;
            background-color: rgba(44, 62, 80, 0.7);
            color: #f1f1f1;
            padding: 6px 8px;
            border-radius: 8px;
            margin-top: auto;
            position: relative;
            z-index: 2;
            text-shadow: 1px 1px 2px black;
            transition: background-color 0.3s ease;
        }
        .pdf-buttons-container .pdf-button:hover .button-name {
            background-color: rgba(26, 188, 156, 0.8);
        }
        .pdf-buttons-container .pdf-button .tooltip {
            display: none;
            background-color: rgba(0, 0, 0, 0.8);
            color: #ECF0F1;
            padding: 10px;
            border-radius: 5px;
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            width: 180%;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .pdf-buttons-container .pdf-button:hover .tooltip {
            display: block;
            opacity: 1;
        }
        .pdf-buttons-container .pdf-button:hover::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
        }
        .hidden {
            display: none;
        }
        .buttons-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        #botonesContenido {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        button {
            margin: 0 5px;
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            background-color: #2980B9;
            color: white;
            font-size: 1em;
            transition: background-color 0.3s ease, transform 0.2s ease;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        button:hover {
            background-color: #1ABC9C;
            transform: scale(1.05);
        }
        .texto-capitulo {
            margin-top: 5px;
            color: #000;
            font-size: 14px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1;
            display: none;
            text-align: center;
            max-width: 150px;
            white-space: normal;
            word-wrap: break-word;
            font-weight: bold;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 5px;
            padding: 5px;
        }
        .manga-style .pdf-button,
        .novela-ligera-style .pdf-button {
            height: 300px;
            width: 200px;
        }
        .manga-style .pdf-button img,
        .novela-ligera-style .pdf-button img {
            max-height: 270px;
            max-width: 270px;
        }
        .anime-style .pdf-button {
            height: 220px;
            width: 320px;
        }
        .anime-style .pdf-button img {
            max-height: 290px;
            max-width: 290px;
        }
        #pdfButtons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            position: relative;
            z-index: 5;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
            overflow-y: auto;
        }
        #paginationButtons {
            display: flex;
            justify-content: space-between;
            position: fixed;
            bottom: 20px;
            left: 0;
            right: 0;
            z-index: 10;
            padding: 0 40px;
        }
        #paginationButtons button {
            background-color: #333;
            color: white;
            padding: 5px 10px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            border-radius: 5px;
        }
        #paginationButtons button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .page-numbers {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin-top: 15px;
            position: fixed;
            bottom: 70px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
        }
        .page-numbers button {
            background-color: #555;
            color: white;
            padding: 5px 10px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            border-radius: 5px;
        }
        .page-numbers button.active {
            background-color: #f39c12;
        }
        .page-numbers button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div id="informacionLibro" class="libro-container">
        <h2 id="nombreLibro"></h2>
        <p id="resumenLibro"></p>
        <div id="botonesContenido" class="botones-contenido">
            <button id="botonManga">Manga</button>
            <button id="botonNovelaLigera">Novela Ligera</button>
            <button id="botonAnime">Anime</button>
        </div>
    </div>
    <img src="" id="imagenLibro" class="imagen-fondo">
    <div id="pdfButtons" class="pdf-buttons-container buttons-row"></div>
    <div id="pageNumbers" class="page-numbers"></div>
    <script type="module">
        import { libros } from '../Data.js';
        let currentIndex = 0;
        let maxVisibleItems = 5;
        let items = [];
        function buscarLibroPorId(idLibro) {
            return libros.find(libro => libro.id === idLibro);
        }

        function mostrarInformacionLibro(libro) {
            document.getElementById('nombreLibro').textContent = libro.nombre;
            document.title = libro.nombre;
            const imagenLibro = document.getElementById('imagenLibro');
            const googleDriveId = libro.imagenInterior;
            imagenLibro.src = `https://lh3.googleusercontent.com/d/${googleDriveId}`;
            imagenLibro.alt = libro.nombre;
            document.getElementById('resumenLibro').textContent = libro.resumen;
            if (libro.ContenidoManga) {
                mostrarContenido('ContenidoManga', libro);
            } else if (libro.ContenidoNovelaLigera) {
                mostrarContenido('ContenidoNovelaLigera', libro);
            } else if (libro.ContenidoAnime) {
                mostrarContenido('ContenidoAnime', libro);
            }
        }

        function mostrarContenido(tipoContenido, libro) {
            const pdfButtonsContainer = document.getElementById('pdfButtons');
            pdfButtonsContainer.innerHTML = '';
            pdfButtonsContainer.classList.remove('manga-style', 'novela-ligera-style', 'anime-style');
            const estilos = {
                'ContenidoManga': 'manga-style',
                'ContenidoNovelaLigera': 'novela-ligera-style',
                'ContenidoAnime': 'anime-style'
            };
            pdfButtonsContainer.classList.add(estilos[tipoContenido]);
            const contenidoSeleccionado = libro[tipoContenido];
            const idLibro = libro.id;
            items = Object.keys(contenidoSeleccionado).map(clave => {
                const { codigo, texto, imagen } = contenidoSeleccionado[clave];
                return crearPdfButton(
                    codigo,
                    texto,
                    imagen,
                    tipoContenido.replace('Contenido', ''),
                    clave,
                    idLibro
                );
            });
            crearBotonesPaginacion();
            actualizarBotones();
        }

        function crearBotonesPaginacion() {
            const totalPages = Math.ceil(items.length / maxVisibleItems);
            const pageNumbersContainer = document.getElementById('pageNumbers');
            pageNumbersContainer.innerHTML = '';
            for (let i = 1; i <= totalPages; i++) {
                const pageButton = document.createElement('button');
                pageButton.textContent = i;
                pageButton.addEventListener('click', function () {
                    currentIndex = (i - 1) * maxVisibleItems;
                    actualizarBotones();
                    actualizarBotonActivo(i);
                });
                pageNumbersContainer.appendChild(pageButton);
            }
        }

        function actualizarBotonActivo(page) {
            const buttons = document.querySelectorAll('.page-numbers button');
            buttons.forEach(btn => btn.classList.remove('active'));
            if (buttons[page - 1]) {
                buttons[page - 1].classList.add('active');
            }
        }

        function actualizarBotones() {
            const pdfButtonsContainer = document.getElementById('pdfButtons');
            if (!pdfButtonsContainer) return;
            pdfButtonsContainer.innerHTML = '';
            const visibleItems = items.slice(currentIndex, currentIndex + maxVisibleItems);
            visibleItems.forEach(item => pdfButtonsContainer.appendChild(item));
            mostrarBotonesNavegacion();
            const btnAnterior = document.getElementById('btnAnterior');
            const btnSiguiente = document.getElementById('btnSiguiente');
            if (btnAnterior) btnAnterior.disabled = currentIndex === 0;
            if (btnSiguiente) btnSiguiente.disabled = currentIndex + maxVisibleItems >= items.length;
        }

        function mostrarBotonesNavegacion() {
            const paginationContainer = document.getElementById('paginationButtons');
            if (!paginationContainer) return;
            paginationContainer.innerHTML = '';
            const prevButton = document.createElement('button');
            prevButton.id = 'btnAnterior';
            prevButton.textContent = '<';
            prevButton.disabled = currentIndex === 0;
            prevButton.addEventListener('click', function () {
                if (currentIndex > 0) {
                    currentIndex -= maxVisibleItems;
                    actualizarBotones();
                    actualizarBotonActivo(Math.ceil(currentIndex / maxVisibleItems) + 1);
                }
            });
            const nextButton = document.createElement('button');
            nextButton.id = 'btnSiguiente';
            nextButton.textContent = '>';
            nextButton.disabled = currentIndex + maxVisibleItems >= items.length;
            nextButton.addEventListener('click', function () {
                if (currentIndex + maxVisibleItems < items.length) {
                    currentIndex += maxVisibleItems;
                    actualizarBotones();
                    actualizarBotonActivo(Math.ceil(currentIndex / maxVisibleItems) + 1);
                }
            });
            paginationContainer.appendChild(prevButton);
            paginationContainer.appendChild(nextButton);
        }

        function crearPdfButton(codigo, texto, imagenSrc, tipoContenido, clave, idLibro) {
            const divContenido = document.createElement('div');
            divContenido.classList.add('pdf-button');
            const img = document.createElement('img');
            const googleDriveId = imagenSrc;
            img.src = `https://lh3.googleusercontent.com/d/${googleDriveId}`;
            img.alt = tipoContenido;
            img.loading = 'lazy';
            const nombreDiv = document.createElement('div');
            nombreDiv.textContent = clave;
            nombreDiv.classList.add('button-name');
            const textoDiv = document.createElement('div');
            textoDiv.textContent = texto;
            textoDiv.classList.add('texto-capitulo');
            textoDiv.style.display = 'none';
            const imagenCapitulo = document.createElement('img');
            imagenCapitulo.src = `https://lh3.googleusercontent.com/d/${googleDriveId}`;
            imagenCapitulo.alt = tipoContenido;
            imagenCapitulo.classList.add('imagen-capitulo');
            imagenCapitulo.style.display = 'none';
            imagenCapitulo.loading = 'lazy';
            divContenido.appendChild(img);
            divContenido.appendChild(nombreDiv);
            divContenido.appendChild(textoDiv);
            divContenido.addEventListener('click', function () {
                window.location.href = `./genericoContenido.html?idArchivo=${codigo}&idLibro=${idLibro}`;
            });
            divContenido.addEventListener('mouseenter', function () {
                imagenCapitulo.style.display = 'block';
                textoDiv.style.display = 'block';
            });
            divContenido.addEventListener('mouseleave', function () {
                imagenCapitulo.style.display = 'none';
                textoDiv.style.display = 'none';
            });
            return divContenido;
        }
    
        document.addEventListener('DOMContentLoaded', async function () {
            const urlParams = new URLSearchParams(window.location.search);
            const idLibro = urlParams.get('id');
            const libro = buscarLibroPorId(idLibro);
            const botonNovelaLigera = document.getElementById('botonNovelaLigera');
            const botonManga = document.getElementById('botonManga');
            const botonAnime = document.getElementById('botonAnime');
            botonManga.style.display = 'none';
            botonNovelaLigera.style.display = 'none';
            botonAnime.style.display = 'none';
            function configurarBoton(boton, tipoContenido) {
                if (libro[tipoContenido]) {
                    boton.style.display = 'inline-block';
                    boton.addEventListener('click', function() {
                        mostrarContenido(tipoContenido, libro);
                    });
                }
            }
            configurarBoton(botonManga, 'ContenidoManga');
            configurarBoton(botonNovelaLigera, 'ContenidoNovelaLigera');
            configurarBoton(botonAnime, 'ContenidoAnime');
            mostrarInformacionLibro(libro);
        });
    </script>
</body>
</html>